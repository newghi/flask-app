# 구글 시트 연동 설정 가이드

## 1. 구글 클라우드 콘솔 설정

### 1.1 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com/)에 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택

### 1.2 Google Sheets API 활성화
1. 왼쪽 메뉴에서 "API 및 서비스" > "라이브러리" 선택
2. "Google Sheets API" 검색 후 활성화

### 1.3 사용자 인증 정보 생성
1. "API 및 서비스" > "사용자 인증 정보" 선택
2. "사용자 인증 정보 만들기" > "OAuth 2.0 클라이언트 ID" 선택
3. 애플리케이션 유형: "데스크톱 앱" 선택
4. 이름 입력 후 "만들기" 클릭
5. JSON 파일 다운로드

### 1.4 credentials.json 파일 설정
1. 다운로드한 JSON 파일을 프로젝트 루트 디렉토리에 `credentials.json`으로 이름 변경
2. 파일이 `app.py`와 같은 폴더에 있는지 확인

## 2. 구글 시트 권한 설정

### 2.1 시트 공유 설정
1. [구글 시트](https://docs.google.com/spreadsheets/d/1zyblfK01GQE9XIaj_jteo3XcA0je21C9TbIPjU550JM/edit?gid=1054888068#gid=1054888068) 열기
2. 우측 상단 "공유" 버튼 클릭
3. OAuth 클라이언트 이메일 주소에 편집 권한 부여
   - 이메일 주소는 `credentials.json` 파일에서 확인 가능

## 3. 첫 실행 시 인증

### 3.1 애플리케이션 실행
```bash
python app.py
```

### 3.2 브라우저 인증
1. 첫 번째 구글 시트 동기화 시도 시 브라우저가 자동으로 열림
2. 구글 계정으로 로그인
3. 권한 요청 승인
4. `token.pickle` 파일이 자동으로 생성됨

## 4. 동기화 기능

### 4.1 자동 동기화
- 새 주문 접수 시 자동으로 시트11에 업데이트
- 주문 상태 변경 시 자동으로 시트11에 업데이트

### 4.2 수동 동기화
- 관리자 페이지에서 "📊 구글시트 동기화" 버튼 클릭
- 모든 주문 데이터를 시트11에 동기화

## 5. 시트11 데이터 형식

| 열 | 내용 |
|---|---|
| A | 주문ID |
| B | 고객명 |
| C | 연락처 |
| D | 수령인 |
| E | 연락처 |
| F | 주소 |
| G | 결제방법 |
| H | 결제상태 |
| I | 주문상태 |
| J | 주문일시 |
| K | 수정일시 |
| L | 총금액 |
| M | 제품정보 |

## 6. 문제 해결

### 6.1 인증 오류
- `credentials.json` 파일이 올바른 위치에 있는지 확인
- 구글 시트에 편집 권한이 있는지 확인

### 6.2 토큰 만료
- `token.pickle` 파일 삭제 후 재실행
- 브라우저에서 다시 인증

### 6.3 API 할당량 초과
- Google Cloud Console에서 할당량 확인
- 필요시 할당량 증가 요청

## 7. 보안 주의사항

- `credentials.json`과 `token.pickle` 파일을 Git에 커밋하지 마세요
- `.gitignore`에 다음 항목 추가:
```
credentials.json
token.pickle
``` 